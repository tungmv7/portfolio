/* PageLines Platform - 5.0.134
* Built: Wednesday, April 6th, 2016, 20:13
* http://www.pagelines.com
* Copyright (c) 2016 PageLines; Licensed GPL-3.0 */
!function(a){a.plBuilder={init:function(b){var c=this,b=b||a("body"),d=b.data("clone")||!1,e={name:plTranslate("page_builder"),panels:c.thePanels(),key:"builder",call:function(){c.bindListActions(d)}};a.plEditing.sidebarEngine(e)},doSortables:function(){var b=this;a(".dd-sort").pagesort({group:"builder",animation:250,draggable:".dd-item",onAdd:function(){b.dragDropUpdate()},onUpdate:function(a){b.dragDropUpdate()},onEnd:function(){a(".pl-builder-list").find(".dd-item").css("transform","")}}),a(".dd-sub-sort").pagesort({group:"builder",animation:250,draggable:".dd-item"})},bindListActions:function(b){var c=this;if(c.doSortables(),b){var d=a(".pl-builder-list").find(sprintf('[data-clone="%s"]',b));d.addClass("item-highlight"),setTimeout(function(){d.removeClass("item-highlight")},2e3)}a(".pl-builder-list").delegate(".dd-control","click",function(b){b.stopPropagation();var d="control_"+a(this).data("tool");a.isFunction(c[d])&&c[d].call(c,a(this))}),a(".dd-builder li.dd-item .dd-handle").each(function(b,c){a(c).on("dblclick",function(){btn=a(this),a.plBuilder.control_options(btn)})}),a(".select-new-add-item").on("click",function(){var b=a(this),d=b.data("class"),e=b.data("loading"),f=plUniqueID(),g=c.getSection(d),h=g.name,i=1==g.contain?"parent-item":"",j=1==g.contain?c.getListWrap():"",k=c.getListElement({object:d,clone:f,name:h,parentCl:i,sublist:j});"refresh"==e?a.plFrame.reloadFrame({addSections:JSON.stringify([d])}):$jq().plAdd.newSection(d,f,k)})},getSection:function(a){return section=plIsset(PLWorkarea.factory[a])?PLWorkarea.factory[a]:!1,section},control_grid:function(b){var c=this,d=b.closest(".dd-item"),e=(d.data("object"),d.data("clone")),f=c.getColumnSize(d),g=c.getOffsetSize(d),h=b.data("action");"increase"==h||"decrease"==h?(d.removeClass(f[0]),"decrease"==h?(d.addClass(f[2]),$plModel().setSectionOption(e,"col",f[5])):"increase"==h&&(d.addClass(f[1]),$plModel().setSectionOption(e,"col",f[4]))):"offmore"!=h&&"offless"!=h||(d.removeClass(g[0]),"offless"==h?(d.addClass(g[2]),$plModel().setSectionOption(e,"offset",g[5])):"offmore"==h&&(d.addClass(g[1]),$plModel().setSectionOption(e,"offset",g[4]))),a.plEditing.setNeedsSave()},control_dropdown:function(b){var c=b.closest(".dd-item"),d=(c.parent(),"");c.find(".dd-dropdown").length>0?c.removeClass("dd-show").find(".dd-dropdown").remove():(a(".dd-dropdown").remove(),a(".dd-show").removeClass("dd-show"),-1==b.attr("title").indexOf("Missing")?(d+='<div class="dd-li"><span class="a">',d+='<span class="dd-control dd-in" data-tool="grid" data-action="decrease"><i class="pl-icon pl-icon-caret-left"></i></span>',d+='<span class="dd-control dd-in" data-tool="grid" data-action="increase"><i class="pl-icon pl-icon-caret-right"></i></span>',d+=sprintf("%s</span></div>",plTranslate("cols")),d+='<div class="dd-li"><span class="a">',d+='<span class="dd-control dd-in" data-tool="grid" data-action="offless"><i class="pl-icon pl-icon-caret-left"></i></span>',d+='<span class="dd-control dd-in" data-tool="grid" data-action="offmore"><i class="pl-icon pl-icon-caret-right"></i></span>',d+=sprintf("%s</span></div>",plTranslate("offset")),d+=sprintf('<div class="dd-li"><a class="dd-control" data-tool="options" ><i class="pl-icon pl-icon-pencil"></i> %s</a></div>',plTranslate("edit")),d+=sprintf('<div class="dd-li"><a class="dd-control" data-tool="show" ><i class="pl-icon pl-icon-eye"></i> %s </a></div>',plTranslate("show")),plBuilderEditOnly()||(d+=sprintf('<div class="dd-li"><a class="dd-control" data-tool="clone" ><i class="pl-icon pl-icon-file-text"></i> %s</a></div>',plTranslate("clone")),d+=sprintf('<div class="dd-li"><a class="dd-control" data-tool="delete" ><i class="pl-icon pl-icon-remove"></i> %s</a></div>',plTranslate("delete")))):d+=sprintf('<div class="dd-li"><a class="dd-control" data-tool="delete" ><i class="pl-icon pl-icon-remove"></i> %s</a></div>',plTranslate("delete")),c.addClass("dd-show").children(".dd-item-wrap").children(".dd-title").after(sprintf('<div class="dd-dropdown">%s</div>',d))),a("body").on("click.closeDDDropdown",function(){a(".dd-dropdown").remove(),a(".dd-show").removeClass("dd-show"),a(this).unbind("click.closeDDDropdown")})},control_options:function(b){var c=b.closest(".dd-item").data("clone"),d=$i(sprintf('[data-clone="%s"]',c));a(".tool-active").removeClass("tool-active"),$jq().plScrolling.scrollToSection(d),a.plEditing.loadSectionOptions(d)},control_delete:function(b){var c=b.closest(".dd-item"),d=c.data("clone");a.plEditing.deleteSection(b,d)},control_clone:function(b){var c=this,d=b.closest(".dd-item"),e=d.data("clone"),f=$i(sprintf('[data-clone="%s"]',e)).first(),g=d.clone(),h=f.clone();h.insertAfter(f).hide().fadeIn(),g.insertAfter(d).hide().fadeIn(),a("body").click(),c.updateCloneData(g,h),c.updateTemplateMap(),a.plEditing.reloadUI(),$iWindow().plTrigger("ready")},updateCloneData:function(b,c){var d=this,e=b.data("clone"),f=plUniqueID();c.attr("data-clone",f).data("clone",f),b.attr("data-clone",f).data("clone",f),plIsset($pl().modelData[e])?(c.find("[data-bind]").each(function(){var b=a(this).attr("data-bind");b.indexOf("foreach")>=0?a(this).children("*:gt(0)").remove():b.indexOf("template")>=0&&a(this).empty()}),$plModel().updateModelData(),$pl().modelData[f]=a.extend({},$pl().modelData[e]),$plBinding().bindNewSection(f,$pl().modelData[f])):console.log("model data not set"),b.find("[data-clone]").each(function(){var b=a(this),e=a(this).data("clone"),f=c.find(sprintf('[data-clone="%s"]',e));d.updateCloneData(b,f)})},control_show:function(a){var b=a.closest(".dd-item").data("clone"),c=$i(sprintf('[data-clone="%s"]',b));$jq().plScrolling.scrollToSection(c)},getOffsetSize:function(a,b){var c=this,d=10,e=0,f=c.getColumnSize(a),g=12-f[3],h=[],j="pl-col-sm-offset-";for(i=e;i<=d;i++)next=i===g?e:i+1,prev=i<=e?g:i-1,a.hasClass(j+i)&&(h=new Array(j+i,j+next,j+prev,i,next,prev));return 0===h.length||b?new Array(j+"0",j+"0",j+"0","0 Off",i):h},getColumnSize:function(a,b){var c=12,d=3,e=[],f="pl-col-sm-";for(i=d;i<=c;i++)next=i===c?d:i+1,prev=i===d?c:i-1,a.hasClass(f+i)&&(e=new Array(f+i,f+next,f+prev,i,next,prev));return 0===e.length||b?new Array(f+"12",f+"1",f+"11","12 Cols",12):e},updateTemplateMap:function(){var b=this;$pl().config.tplMap=b.getLevelMap(a(".pl-builder-list"),-1),a.plEditing.setNeedsSave(),a(".pl-builder-list").find(".dd-item").css("transform","")},dragDropUpdate:function(){var a=this;a.updateTemplateMap(),a.reDrawPage($pl().config.tplMap,-1,$i("body")),$iWindow().plTrigger("redraw")},reDrawPage:function(b,c,d){var e=this;a.each(b,function(a,b){var f=$i(sprintf('[data-clone="%s"]',b.clone)),g=(f.data("level"),c+1);if(-1!=c&&(f.data("level",c).attr("data-level",c),f.detach().appendTo(d)),!_.isEmpty(b.content)){var h=f.find("[data-contains-level]").first();_.isEmpty(h)||e.reDrawPage(b.content,g,h)}})},getLevelMap:function(b,c){var d=this,c=c||0,e={};return b.children(".dd-item-wrap").children(".itemset").children(".dd-list").each(function(b){var f=a(this),g={};a(this).children(".dd-item").each(function(b){var e=a(this),f=(a(this).data("clone"),a(this).data("index")||b);e.children(".dd-item-wrap").children(".itemset").children(".dd-list").attr("data-level",c+1).data("level",c+1),g[f]={clone:e.data("clone"),object:e.data("object"),content:d.getLevelMap(e,c+1)}}),e=f.hasClass("no-list")?$pl().config.tplMap[f.data("region")].content:g}),e},opt_type_add_sections:function(){var a=this,b=a.builderAddList();return sprintf("%s",b)},opt_type_builder:function(){var a=this,b="";return b=a.builderList($pl().config.tplMap,-1),sprintf('<div class="dd-builder"><div class="pl-builder-list dd-list-container"><div class="dd-item-wrap">%s</div></div></div>',b)},opt_type_scope:function(){var b="",c={};if(c.type=sprintf('%s: "%s"',plTranslate("all_of_type"),plCap($pl().config.typename)),$pl().config.pageslug!=$pl().config.typeslug&&(c.local=sprintf('%s: "%s"',plTranslate("current_page_only"),plCap($pl().config.currentPageName))),$pl().config.termslug!=$pl().config.pageslug){var d=plCap($pl().config.currentTaxonomy.replace("tpl-",""));"page"==$pl().config.typeslug?c.term=sprintf('%s: "%s"',"Page Template",d):c.term=sprintf('%s: "%s"',plTranslate("taxonomy_archive"),d)}return b=a.engineOpts.selectOption(c,$pl().config.tplMode,"tpl_scope")},opt_type_paste_sections:function(){var b="";return b+=sprintf('<div class="paste-section"><input id="spaste" class="paste-section-data pl-form-control" type="text" placeholder="Paste section data here..." /><span class="pl-btn pl-btn-primary pl-btn-xs submit-paste-section"><i class="pl-icon pl-icon-plus"></i> Add Section</span></div>'),a.engineOpts.optScripts.paste_section=function(){a(".submit-paste-section").on("click",function(){var b=a(this).parent(),c=b.find(".paste-section-data");a.plFrame.reloadFrame({loadMap:encodeURIComponent(c.val())})})},b},builderList:function(b,c,d){var e=this,c=c||0,f=0==c?sprintf('<div class="filter-title item-toggle">%s</div>',d):"",g="",d=d||"",h="",i="",j=$pl().config.tplRender,k=($pl().config.tplCapture,!0),l=!0;if(c=parseInt(c),k=!(0===c&&!plIsset(j[d])),k||(l=!1,"template"==d&&(l=!0),l||(i=sprintf('<div class="pl-alert pl-alert-workarea"><strong class="subtle">%s %s.</strong></div>',plTranslate("using_a_theme"),d))),k&&l){var m=$pl().extraData.disabled_regions;!0===m[d]&&(i=sprintf('<div class="pl-alert pl-alert-workarea"><strong class="subtle">%s.</strong></div>',plTranslate("region_disabled")),l=!1)}l&&a.each(b,function(b,d){var f=d.object,h=d.clone,i=plIsset(d.content)?d.content:[],j=plIsset(PLWorkarea.factory[f])?PLWorkarea.factory[f]:!1,k=j?sectionNameFromObject(f):sprintf("(Missing: %s)",d.object),l=$plModel().getSectionOption(h,"custom_name")||!1,k=l?sprintf("%s %s",l,k):k,m=!!(j&&1==j.contain||-1==c),n=m?e.builderList(i,c+1,b):"",o=m?"parent-item":"",p=$plModel().getSectionOption(h,"col"),q=$plModel().getSectionOption(h,"offset"),r=$plModel().getSectionOption(h,"hide_on"),s=plIsset(p)&&""!=p?p:"12",t=plIsset(q)&&""!=q?q:"0";if(r){var u="";a.each(r.split(","),function(a,b){b!==$pl().config.editslug&&b!==$pl().config.editID&&b!==$pl().config.pageID||(u="hide-on-page")})}if(-1==c)g+=sprintf('<div class="dd-item" data-clone="%s" data-object="%s" data-index="%s"><div class="dd-item-wrap">%s</div></div>',h,f,f,n);else{var v={col:s,offset:t,hide:u,parentCl:o,clone:h,object:f,name:k,sublist:n};g+=e.getListElement(v)}});var h=e.getListWrap({title:f,region:d,level:c,list:g,staticTpl:i,doList:l});return h},getListWrap:function(b){var c="",d={title:"",region:"",level:"1",list:"",staticTpl:"",doList:!0};return b=a.extend(d,b),region=""!=b.region?sprintf('data-region="%s"',b.region):"",0==b.level?c+="dd-sort":b.level>0&&(c+="dd-sub-sort"),b.doList||(c+=" no-list"),sprintf('<div class="itemset">%s<ol class="item-contents dd-list fix %s" %s data-level="%s">%s</ol>%s</div>',b.title,c,region,b.level,b.list,b.staticTpl)},getListElement:function(b){var c={col:"12",offset:"0",parentCl:"",clone:"",object:"",name:"",sublist:"",hide:""};b=a.extend(c,b),""!=b.hide?sName=b.name+" ("+plTranslate("hidden")+")":sName=b.name;var d=a.plEditing.reorderIcon(),e=sprintf('<div class="dd-el dd-name dd-control" title="%s Section" data-tool="dropdown">%s <i class="pl-icon pl-icon-caret-down"></i></div>',b.name,sName);return sprintf('<li class="dd-item pl-col-sm-%s pl-col-sm-offset-%s %s %s" data-clone="%s" data-object="%s" ><div class="dd-item-wrap"><div class="dd-title dd-handle clearfix">%s %s</div>%s</div></li>',b.col,b.offset,b.parentCl,b.hide,b.clone,b.object,e,d,b.sublist)},sectionFilters:function(){var a={basic:plTranslate("basic"),content:plTranslate("content_formats"),layout:plTranslate("layout_containers"),component:plTranslate("components"),nav:plTranslate("navigation_menus"),carousel:plTranslate("carousel"),gallery:plTranslate("gallery"),slider:plTranslate("sliders_features"),wordpress:"WordPress",localsocial:plTranslate("social_local"),widgetized:plTranslate("widgets_sidebar"),advanced:plTranslate("advanced")};return a},builderAddList:function(){var b=this,c="";return a.each(b.sectionFilters(),function(a,d){var e=b.getFilterSections(a);""!=e&&(c+=sprintf('<div class="itemset"><div class="filter-title item-toggle">%s</div> %s</div>',d,b.getFilterSections(a)))}),sprintf('<div id="tab-add" class="pl-builder-add dd-list-container">%s</div>',c)},getFilterSections:function(b){var c="";return a.each(PLWorkarea.factory,function(){var d=a(this)[0],e=""==d.filter?"advanced":d.filter,f=e.split(","),g=a.inArray(b,f)>-1;if(g){var h="refresh"==d.loading?sprintf('<span class="sicons"><i class="pl-icon pl-icon-refresh"></i></span>'):"";c+=sprintf('<li title="%s" class="dd-item select-new-add-item fix" data-class="%s" data-loading="%s">%s<div class="list-icon" style="background-image: url(%s)"></div><div class="list-content"><div class="title">%s</div></div></li>',d.desc,d["class"],d.loading,h,d.icon,d.name)}}),""!=c?sprintf('<ul class="item-contents list-grid">%s</ul>',c):""},thePanels:function(){var a=this,b={scope:{title:plTranslate("scope"),opts:[{type:"scope",callback:a}]},builder:{title:plTranslate("page_layout"),format:"full",opts:[{type:"builder",callback:a}]},add:{title:plTranslate("add_sections_to_page"),format:"full",opts:[{type:"add_sections",callback:a}]},paste:{title:plTranslate("section_copy_paste"),opts:[{type:"paste_sections",callback:a}]}};return plBuilderEditOnly()&&(b=[b.builder]),b}}}(window.jQuery),!function(a){a(document).ready(function(){a.plEditing.init(),a.plEditing.bindIFrame()}),a.plEditing={init:function(){var a=this;a.setupWPAdminBar(),a.bindUIActions(),a.closeScripts={}},bindIFrame:function(){var b=this,c="plBuilder";a("iframe.site-frame").on("load",function(){b.startUI(),$i("#wpadminbar").length>0&&($i("#wpadminbar").hide(),$i("html").css("cssText","margin-top: 0px !important;")),a(".tool-active").first().length>0&&0==a(".pl-workarea-sidebar").data("persist")?b.editingAction(a(".tool-active").first().attr("rel")):"yes"==getURLParameter("start")&&(getURLParameter("pl_tool")&&(c=getURLParameter("pl_tool")),b.editingAction(c,!1,a(sprintf('[rel="%s"]',c)).first()))})},bindUIActions:function(){var a=this;a.doToolbarBinding()},setupWPAdminBar:function(){a(".pl-ab-save > a").addClass("toolbar-save").attr("data-action","save").data("action","save")},doToolbarBinding:function(){var b=this;a(".pl-ab-item > a").on("click",function(c){c.preventDefault(),a("body").click();var d=a(this);b.clickTool(d)})},startUI:function(){var b=this;$i("body").addClass("pldd-active"),$i(".pl-sn").each(function(){a(this).children(".pl-sn-wrap").prepend(b.getSectionToolbar(a(this)))}),$i(".pldd-control").on("click.pldd",function(c){c.preventDefault(),c.stopPropagation(),$i("body").click(),b.clickTool(a(this))})},reloadUI:function(){var a=this;a.closeTools(),a.shutdownEditing(),a.startUI()},clickTool:function(a){var b=this;b.editingAction(a.attr("rel"),a.data("action"),a)},editingAction:function(b,c,d){var e=this,c=c||!1,b=b||!1,d=d||!1,f="action_",g="tool-active";c&&e.callFunction(f+c,d),b&&(a("."+g).removeClass(g),a(sprintf('[rel="%s"]',b)).addClass(g),e.callFunction("init",d,b))},callFunction:function(b,c,d){var e=this,f=plIsset(d)?a[d]:e;plIsset(f)&&a.isFunction(f[b])?f[b].call(f,c):console.log("PageLines: "+d+":"+b+" does not exist.")},shutdownEditing:function(){$i("body").removeClass("pldd-active pldd-editing"),$i("[class*=pldd-]").remove()},closeTools:function(){a.each(this.closeScripts,function(b,c){a.isFunction(c)&&c.call(this)}),this.closeScripts={}},loadSidebar:function(b){var c={title:"",header:"",sub:"",cont:"",key:"",persist:0};b=a.extend(c,b);var d=this,e=""!==b.sub?sprintf('<div class="sb-sub">%s</div>',b.sub):"",f=""!==b.title?sprintf('<div class="sb-title"><div class="the-title">%s</div>%s</div>',b.title,e):"",g=""!==b.header?sprintf('<div class="sb-header"><div class="the-header fix">%s</div></div>',b.header):"",h=g+f+b.cont;a("body").addClass("pl-has-sidebar"),a(".pl-workarea-sidebar").html(h).data("key",b.key).attr("data-key",b.key).data("persist",b.persist).attr("data-persist",b.persist),PLWorkarea.iframe.contents().bind("click.sidebarClose",d.closeSidebar)},itemToggles:function(){a(".item-toggle").not(".loaded").each(function(){var b=a(this).parent();a(this).append(' <i class="pl-icon pl-icon-caret-down"></i><i class="pl-icon pl-icon-angle-up"></i>');var c=a(this).text(),d=plGetTabState(c);"open"==d?b.addClass("item-open").removeClass("item-closed"):"closed"==d&&b.addClass("item-closed").removeClass("item-open")}),a(".item-toggle").not(".loaded").on("click",function(){var b=a(this).parent(),c=a(this).text();b.hasClass("item-closed")?(b.addClass("item-open").removeClass("item-closed"),plSetTabState(c,"open")):(b.addClass("item-closed").removeClass("item-open"),plSetTabState(c,"closed"))}).addClass("loaded")},bindSidebar:function(){var b=this;a(".btn-ref").on("click.ref",function(){var b=a(this).parent(),c=a(this).next();b.hasClass("ref-open")?(b.removeClass("ref-open"),c.slideUp()):(b.addClass("ref-open"),c.slideDown())}),a(".pl-dropdown-toggle").on("click",function(){var b=a(this).parent().find(".pl-dropdown-menu");b.hasClass("show")?b.removeClass("show"):b.addClass("show")}),b.itemToggles(),a(".pl-tools-list").on("click",".tools-bar",function(){var b=a(this).parent();b.hasClass("item-open")?(b.removeClass("item-open"),a(".pl-tools-list").find(".tools-panel").hide()):(a(".pl-tools-list li").removeClass("item-open"),a(".pl-tools-list").find(".tools-panel").hide(),b.addClass("item-open"),b.find(".tools-panel").fadeIn())}),a(".select-action").on("change",function(){var c="action_"+a(this).data("action");return a.isFunction(b[c])?b[c].call(b,a(this)):console.log("Action not found: "+c),a(this).val(""),!1}),a(".tool-action").on("click",function(){var c=a(this).data("action"),d="toolbar_"+c;a(".tool-active").removeClass("tool-active"),a(sprintf('[data-action="%s"]',c)).addClass("tool-active"),a.isFunction(b[d])?b[d].call(b,a(this)):console.log("Action not found: "+d)})},closeSidebar:function(b){var b=b||!1;target=b?b.target:!1,target&&0!=a(target).closest(".dropdown").length||(PLWorkarea.iframe.contents().unbind("click.sidebarClose"),a(".tool-active").removeClass("tool-active"),$i(".editing-section").removeClass("editing-section"),a("body").removeClass("pl-has-sidebar"))},sidebarEngine:function(b){var c=this,d="",e=1,f=b.panels,g=b.call,h={header:"",closed:"none"};b=a.extend(h,b);var i={title:sprintf('<i class="pl-icon pl-icon-pencil"></i> %s',b.name),header:b.header,cont:sprintf('<div class="workarea-opts-form" data-level="%s"><div class="pl-loader"><i class="pl-icon pl-icon-spin pl-icon-cog"></i></div></div>',b.level,"HTML"),key:b.key,persist:b.persist};a.plEditing.loadSidebar(i),setTimeout(function(){a.engineOpts.init(),d+=sprintf("<div class='panel-accordion'>"),a.each(f,function(c,f){var g="all"==b.closed&&1!==e?"item-closed":"",h=f.format||"options";d+=sprintf('<div class="opt-panel itemset %s"><div class="panel-title item-toggle">%s</div>',g,f.title),("undefined"==typeof f.opts||a.isEmptyObject(f.opts))&&(f.opts=[{label:plTranslate("no_custom_options"),help:plTranslate("no_custom_options_added"),type:"help"}]),d+=sprintf('<div class="panel-opts item-contents format-%s">%s</div></div>',h,a.toolEngine.runEngine(f.opts)),e++}),d+=sprintf("</div>"),a(".workarea-opts-form").html(d),a.isFunction(g)&&g.call(c),a.engineOpts.runScripts(),c.bindSidebar()},150)},action_dropdown:function(b){var c=this,d=b.parent();c.removeLogoDrop(),d.hasClass("show-drop")?(b.removeClass("tool-active"),d.removeClass("show-drop")):d.addClass("show-drop"),PLWorkarea.iframe.contents().on("click.logoDropClose",function(){c.removeLogoDrop()}),a("body").on("click.logoDropClose",function(b){var b=b||!1;target=b?b.target:!1,target&&0!=a(target).closest(".logo-dropdown").length||c.removeLogoDrop()})},removeLogoDrop:function(){a(".show-drop").removeClass("show-drop").find(".tool-active").removeClass("tool-active"),a("body").unbind("click.logoDropClose"),PLWorkarea.iframe.contents().unbind("click.logoDropClose")},action_save:function(){var a=this;a.savePage()},savePage:function(b){var c=this,b=b||{},d=$plModel().getJSON(),e=$pl().config.tplMap;b=a.extend({map:e,model:d},b),b=a.extend($pl().extraData,b),c.savePageConfig(b)},savePageConfig:function(b){var c=this,d={hook:"save_page",postSuccess:function(b){c.setNeedsSave("no"),a.plEditing.showNotification("saved!")},beforeSend:function(){c.setNeedsSave("active")}};b=a.extend(d,b),$plServer().run(b)},setNeedsSave:function(b){var b=b||"yes";"no"==b?(window.needsSave=!1,a(".toolbar-save").removeClass("needs-save").html('<i class="pl-icon pl-icon-ok"></i> Page Saved').parent().removeClass("show-save"),a("body").css("cursor","default"),$iWindow().onbeforeunload=null):"active"==b?(a(".toolbar-save").html('<i class="pl-icon pl-icon-cog pl-icon-spin"></i> Saving Changes').parent().addClass("show-save"),a("body").css("cursor","progress")):(window.needsSave=!0,a(".toolbar-save").addClass("needs-save").html(sprintf('<i class="pl-icon pl-icon-upload"></i> %s',plTranslate("save_changes"))).parent().addClass("show-save"),$iWindow().onbeforeunload=function(){return sprintf("Save your changes! %sYou will lose your unsaved edits if you continue.","\n")})},needsSave:function(){return!!a(".toolbar-save").hasClass("needs-save")},showNotification:function(b,c){var c=c||1e3;a(".toolbar-notification").html(b).addClass("active"),setTimeout(function(){a(".toolbar-notification").removeClass("active")},c)},toolbar_layouts:function(b){a.plTemplates.init(b)},toolbar_builder:function(b){a.plBuilder.init(b)},toolbar_code:function(b){a.plCode.init(b)},toolbar_static:function(){var b=$i(".static-template");a("body").click();var c={UID:b.data("clone"),theClass:"template",level:0};a.toolEngine.render(c)},getSectionToolbar:function(a){var b,c=a.data("clone"),d=$plModel().getSectionOption(c,"custom_name")||!1;return b=b||sectionNameFromObject(a.data("object")),b=d?sprintf("%s %s",d,b):b,sprintf('<div class="pldd-section-bar pldd-bar pl-border"><div class="pldd-bar-tools pldd-section-tools"><a class="bar-control pldd-control" data-action="options"><i class="pl-icon pl-icon-pencil"></i>%s</a></div></div>',b)},action_options:function(a){var b=this,c=a.closest(".pl-sn");b.loadSectionOptions(c)},loadSectionOptions:function(b,c){var c=c||{};$i(".editing-section").removeClass("editing-section"),b.addClass("editing-section"),header=sprintf('<div class="tool-action" data-action="builder_show"><i class="pl-icon pl-icon-caret-left"></i> &nbsp;%s</div>',plTranslate("show_in_builder")),plBuilderEditOnly()||(header+=sprintf('<div class="tool-action send-right" data-action="delete"><i class="pl-icon pl-icon-remove"></i> %s</div>',plTranslate("delete"))),mode=b.hasClass("pl-sn-static-content")?"static":"standard";var d={UID:b.data("clone"),theClass:b.data("object"),level:b.data("level"),header:header,mode:mode};c=a.extend({},c,d),a.toolEngine.render(c)},action_tpl_scope:function(b){var c=(b.find("option:selected").text(),b.val());a.plFrame.reloadFrame({tplScope:c})},action_tpl_capture:function(b){var c=(b.find("option:selected").text(),b.val());a.plFrame.reloadFrame({tplCapture:c})},reorderIcon:function(){return'<i class="pl-icon pl-icon-reorder dd-reorder"></i>'},deleteSection:function(b,c,d){var e=this,f=$i(sprintf('[data-clone="%s"]',c));a(".pl-builder-list").find(sprintf('[data-clone="%s"]',c));plConfirm(b,{subhead:plTranslate("remove_from_page"),callback:function(){$pl().config.tplMap=e.parseMap(function(b){return c!=b.meta.clone&&-1===a.inArray(c,b.path)||(plIsset($pl().modelData[b.meta.clone])&&delete $pl().modelData[b.meta.clone],delete b.map[b.index]),b.map}),a.plEditing.setNeedsSave(),a(".pl-builder-list").find(sprintf('[data-clone="%s"]',c)).slideUp("slow",function(){a(this).remove()}),f.slideUp("slow",function(){a(this).remove()}),a.isFunction(d)&&d.call(e,b,f)}})},toolbar_builder_show:function(a){var b=this,c=a.closest(".pl-workarea-sidebar").data("key"),d=$i(sprintf('[data-clone="%s"]',c));a.data("clone",c),$jq().plScrolling.scrollToSection(d),b.editingAction("plBuilder",!1,a)},toolbar_delete:function(a){var b=this,c=a.closest(".pl-workarea-sidebar").data("key");b.deleteSection(a,c,function(){b.toolbar_builder()})},parseMap:function(b,c,d,e){var f=this,e=e||$pl().config.tplMap,c=c||[],d=plIsset(d)?d:-1,g=d+1;return a.each(e,function(h,i){c.splice(g,100,i.clone);var j=c.slice();if(e[h].content=f.parseMap(b,c,g,i.content),a.isFunction(b)){var k={map:e,index:h,meta:i,path:j,level:d};e=b.call(f,k)}}),e}}}(window.jQuery),!function(a){a.toolEngine={defaults:{theClass:"",UID:""},render:function(b){var c=this;c.config=a.extend({},c.defaults,b),c.UID=c.config.UID,c.level=c.config.level,c.factory=PLWorkarea.factory,c.object=c.config.theClass,c.name=c.factory[c.object].name,c.master=c.createMasterOptionsArray(b.mode),c.drawSectionOptions(b)},createMasterOptionsArray:function(b){var c=this,d={};if("static"==b)var e={sections:{title:"Content Settings",opts:$pl().config.templateOpts}};else var e={sections:{title:"Configuration",opts:c.factory[c.config.theClass].opts}};return d=a.extend({},e,a.plStandardSettings.settingsArray())},drawSectionOptions:function(b){var c=this,d={name:c.name,panels:c.master,key:c.UID,level:c.level,header:"",closed:"all",call:function(){c.inputListener()}};b=a.extend(d,b),a.plEditing.sidebarEngine(b)},runEngine:function(b){var c=this,d="";return a.each(b,function(a,b){d+=c.optEngine(b)}),d},sanitizeValue:function(b){var c=this;return _.isObject(b)||_.isArray(b)?a.each(b,function(a,d){b[a]=c.sanitizeValue(d)}):b=pl_html_input(b),b},optGetValue:function(a){var b=this,c=$plModel().getData(),d="";return c[b.UID]&&c[b.UID][a]&&(d=b.sanitizeValue(c[b.UID][a])),d},optAddMeta:function(b,c){var d=this,c=c||{};"undefined"!=typeof c.key?(b.ind=c.ind,b.value=""!=c.vals[b.key]?c.vals[b.key]:"",key=sprintf("%s__%s__%s",c.key,c.ind,b.key)):key=b.key;var e={place:"",classes:"",name:key,value:d.optGetValue(key),inputID:key,callback:d,label:""};return a.extend(e,b)},optEngine:function(b,c){var d=this,e="",c=c||{},b=d.optAddMeta(b,c);if(!_.isEmpty(b.opts)&&"accordion"!=b.type&&b.type.indexOf("select")<0&&b.type.indexOf("radio")<0&&"dragger"!=b.type&&a.each(b.opts,function(a,b){e+=d.optEngine(b,c)}),"undefined"==typeof b.type||"multi"==b.type||"get_posts"==b.type);else if("accordion"===b.type)e+=a.engineOpts.accordion(b);else if("text"===b.type||"text_small"===b.type)e+=a.engineOpts.textoption(b);else if("richtext"===b.type)e+=a.engineOpts.richtext(b);else if("textarea"===b.type||"html"===b.type)e+=a.engineOpts.textarea(b);else if("check"===b.type)e+=a.engineOpts.checkoption(b);else if("image_upload"===b.type)e+=a.engineOpts.imagedropzone(b);else if("color"===b.type)e+=a.engineOpts.coloroption(b);else if("media_select_video"===b.type)e+=a.engineOpts.videooption(b);else if("edit_post"===b.type)e+=sprintf('<a href="%s" class="pl-btn pl-btn-primary pl-btn-xs %s" >%s</a>',PLWorkarea.editPost,b.classes,b.label);else if("link"===b.type){var f=b.target||"_blank",g=b.classes||"pl-btn-default pl-btn-sm";e+=sprintf('<div><a href="%s" class="pl-btn pl-btn-sm %s" target="%s">%s</a></div>',b.url,g,f,b.label)}else"button_link"===b.type?e+=a.engineOpts.buttonLink(b):"select"===b.type||"count_select"===b.type||"count_select_same"===b.type||"select_pixels"===b.type||"select_vw"===b.type||"select_percent"===b.type||"select_proportion"===b.type||"select_same"===b.type||"select_taxonomy"===b.type||"select_term"===b.type||"select_wp_tax"===b.type||"select_icon"===b.type||"select_animation"===b.type||"select_multi"===b.type||"select_button"===b.type||"select_button_size"===b.type||"select_theme"===b.type||"select_sidebar"===b.type||"select_padding"===b.type||"select_imagesizes"===b.type||"select_menu"===b.type?e+=a.engineOpts.selectoption(b):"radio"===b.type?e+=a.engineOpts.radioOption(b):"dragger"===b.type?e+=a.engineOpts.dragInput(b,c):"help"===b.type||"help_important"===b.type?e+=sprintf('<label for="%s">%s</label>',b.inputID,b.label):a.isFunction(b.callback["opt_type_"+b.type])?e+=b.callback["opt_type_"+b.type].call(b.callback,b):e=sprintf('<div class="pl-alert pl-alert-warning">Could not find option type: <strong>%s</strong></div>',b.type);var h="undefined"!=typeof b.help?sprintf('<div class="help-block %s">%s</div>',b.type,b.help):"",i="undefined"!=typeof b.title?sprintf('<div class="opt-title item-toggle">%s</div>',b.title):"",j="undefined"!=typeof b.guide?sprintf('<div class="opt-guide">%s</div>',b.guide):"",k="undefined"!=typeof b.ref?d.doReference(plTranslate("reference"),b.ref):"",l="undefined"!=typeof b.stylize?b.stylize:"",m="undefined"!=typeof b.toggle?"item-"+b.toggle:"";return sprintf('<div class="pl-form-group itemset %s type-%s %s">%s%s<div class="item-contents">%s</div>%s%s</div>',l,b.type,m,i,j,e,h,k)},doReference:function(a,b){return sprintf('<div class="pl-dropdown ref-opt"><span class="pl-btn pl-btn-primary pl-btn-xs pl-dropdown-toggle" >%s <i class="pl-icon pl-icon-angle-down"></i></span><div class="pl-dropdown-menu dd-ref">%s</div></div>',a,b)},resetListenerBinding:function(){var b=this;a(".lstn").off("keyup.optlstn blur.optlstn change.optlstn paste.optlstn"),b.inputListener()},inputListener:function(){$pl().modifyEvent=!1,a(".lstn").on("keyup.optlstn blur.optlstn change.optlstn paste.optlstn",function(b){var c=a(".pl-workarea-sidebar").data("key"),d=a(this),e=d.getInputType(),f=d.attr("name"),g=d.val();if(a.plEditing.setNeedsSave("yes"),"blur"===b.type||"change"===b.type&&("checkbox"===e||"select"===e||"radio"===e||"hidden"===e)?($pl().changeEvent=!0,changeEvent=!0):($pl().changeEvent=!1,changeEvent=!1),modifyEvent=!0,$pl().modifyEvent=!0,f.indexOf("__")>=0){var h=f.split("__"),i=h[0],j=h[2],k=h[1];$pl().viewModel[c][i]()[k][j](g),$pl().viewModel[c][i].valueHasMutated()}else plIsset($pl().viewModel[c][f])||(console.log("*** Unset Model Value: "+f),$plModel().setNewObservable(c,f,g)),$pl().viewModel[c][f].changeEvent=changeEvent,$pl().viewModel[c][f].modifyEvent=modifyEvent,$pl().viewModel[c][f](g);changeEvent?$iWindow().plTrigger("change"):$iWindow().plTrigger("resize")})}}}(window.jQuery),!function(a){window.squire={},window.lastClicked=!1,a.engineOpts={init:function(){this.optScripts={}},runScripts:function(){a.each(this.optScripts,function(b,c){a.isFunction(c)&&c.call(this)})},specialOption:function(b){var c={title:"",message:"",val:"",valLabel:"Current:",option:""};return b=a.extend(c,b),out=sprintf('<div class="alert-help pl-form-group"><div class="itemset item-closed alert-content"><div class="item-toggle"><strong class="alert-title">%s</strong></div><div class="item-contents">%s</div></div> %s</div>',b.title,b.message,b.option),out},selectOption:function(b,c,d,e){var e=e||"Select...",f=sprintf('<option value="">%s</option>',e),g=Object.keys(b).length<=1?"disabled":"";return a.each(b,function(a,b){var d=a==c?"selected":"";f+=sprintf('<option value="%s" %s>%s</option>',a,d,b)}),sprintf('<select class="pl-form-control select-action" data-action="%s" %s>%s</select>',d,g,f)},videooption:function(b){var c=this,d="";a.toolEngine.optAddMeta({key:b.key+"_2"});return d+='<div class="video-upload-inputs option-group">',d+=sprintf('<label for="%s">%s</label>',b.inputID,b.label),d+=sprintf('<div class="video-inputs clearfix">'),d+=c.addVideoOption(b,"Select MP4 Video"),d+=sprintf("</div>"),d+="</div>"},addVideoOption:function(a,b){var c="";return c+='<div class="upload-box media-select-video">',c+=sprintf('<label for="%s">%s</label>',a.inputID,b),c+=sprintf('<input id="%1$s" name="%2$s" type="text" class="lstn pl-form-control upload-input" placeholder="" value="%3$s" />',a.inputID,a.name,a.value),c+='<a class="pl-btn pl-btn-xs pl-btn-primary pl-load-media-lib" data-mimetype="video"><i class="pl-icon pl-icon-edit"></i> Select</a> ',c+=sprintf(' <a class="pl-btn pl-btn-default pl-btn-xs" href="%s" target="_blank"><i class="pl-icon pl-icon-upload"></i> Upload</a> <div class="pl-btn pl-btn-default pl-btn-xs pl-image-remove"><i class="pl-icon pl-icon-remove"></i></div>',PLWorkarea.addMediaURL),c+="</div>"},
textoption:function(a){var b="";return b+=sprintf('<label for="%s">%s</label>',a.inputID,a.label),b+=sprintf('<input type="text" id="%s" name="%s" class="%s lstn pl-form-control" placeholder="%s" value="%s" />',a.inputID,a.name,a.classes,a.place,a.value,a.inputID)},textarea:function(a){var b="",c="html"==a.type?"html-textarea":"";return b+=sprintf('<label for="%s">%s</label>',a.inputID,a.label),b+=sprintf('<textarea id="%s" name="%s" class="%s lstn pl-form-control nowrap %s" placeholder="%s">%s</textarea>',a.inputID,a.name,a.classes,c,a.place,a.value),this.optScripts.textarea=function(){},b},richtext:function(b){var c="",d=0==b.controls?"display: none;":"",e=b.height||!1,f=0!=e?sprintf("height: %s;",e):"";return c+=sprintf('<label for="%s">%s</label>',b.inputID,b.label),c+=sprintf('<div class="richtext-controls noselect" data-id="%s" style="%s">',b.inputID,d),c+='<span class="ctrl" data-action="bold" data-tag="b"><i class="pl-icon pl-icon-bold"></i></span>',c+='<span class="ctrl" data-action="italic" data-tag="i"><i class="pl-icon pl-icon-italic"></i></span>',c+='<span class="ctrl" data-action="underline" data-tag="u"><i class="pl-icon pl-icon-underline"></i></span>',c+='<span class="ctrl" data-action="align" data-tag="left"><i class="pl-icon pl-icon-align-left"></i></span>',c+='<span class="ctrl" data-action="align" data-tag="center"><i class="pl-icon pl-icon-align-center"></i></span>',c+='<span class="ctrl" data-action="align" data-tag="right"><i class="pl-icon pl-icon-align-right"></i></span>',c+='<span class="pl-dropdown">',c+='<span class="ctrl pl-dropdown-toggle"><i class="pl-icon pl-icon-chevron-up"></i></span>',c+='<div class="pl-dropdown-menu" >',c+='<span class="ctrl" data-action="format" data-tag="h1">H1</span> <span class="ctrl" data-action="format" data-tag="h2">H2</span> <span class="ctrl" data-action="format" data-tag="h3">H3</span><span class="ctrl" data-action="format" data-tag="h4">H4</span><span class="ctrl" data-action="format" data-tag="p">P</span>',c+="</div></span>",c+="</div>",c+=sprintf('<iframe class="richtext-frame noselect" src="%s/plugins/squire/document.html" data-inputid="%s" style="%s"></iframe>',PLWorkarea.PLUI,b.inputID,f),c+=sprintf('<textarea id="%s" name="%s" class="%s richtext-textarea lstn pl-form-control"  style="">%s</textarea>',b.inputID,b.name,b.classes,b.value),c+='<div class="richtext-toggle pl-btn pl-btn-default pl-btn-xs">Toggle <span class="sel-richtext">Rich Text</span><span class="sel-rawtext">Raw Text</span></div>',this.optScripts.richtext=function(){a(".richtext-frame").on("load",function(){var b=a(this).data("inputid"),c=a(this).next();top.squire[b]=this.contentWindow.editor,top.squire[b].setHTML(c.val()),a(top.squire[b]).on("input",function(){var a=top.squire[b].getHTML(),d="<div><br></div>";a==d&&(a="",top.squire[b].setHTML(a)),c.val(a).trigger("change")}),c.on("keyup",function(){top.squire[b].setHTML(a(this).val())}),a(".richtext-controls").on("click",function(a){lastClicked=!0}),a(top.squire[b]).on("blur",function(a){setTimeout(function(){lastClicked||c.trigger("blur"),lastClicked=!1},200)})}),a(".richtext-toggle").on("click",function(){var b=a(this).parent().find(".richtext-textarea"),c=a(this).parent().find(".richtext-controls"),d=a(this).parent().find(".richtext-frame"),e=a(this).find(".sel-richtext"),f=a(this).find(".sel-rawtext");a([b,c,d,f,e]).each(function(){a(this).toggle()})}),a(".richtext-controls [data-action]").on("click",function(b){var c,d=a(this).closest(".richtext-controls").data("id"),e=a(this).data("action"),f=a(this).data("tag")||!1,g=squire[d];"format"==e?e&&g&&g.changeFormat({tag:"SPAN",attributes:{"data-type":"size","class":f}},{tag:"SPAN",attributes:{"data-type":"size"}}):("align"==e?(e="setTextAlignment",c=f):f&&g.hasFormat(f)&&(e="remove"+capitalizeFirstLetter(e)),e&&g&&g[e]&&g[e](c))})},c},dragInput:function(b,c){var d="",e=b.unit||"px",f=b.scale||1;return d+=sprintf('<label class="label-block" for="%s">%s <a class="dragger-reset">reset</a></label>',b.inputID,b.label),d+=sprintf('<div class="form-inline dragger-option">'),_.each(b.opts,function(b){b=a.toolEngine.optAddMeta(b,c);var g=b.max||1e3,h=b.min||0,i=b.def||0;e=plIsset(b.unit)?b.unit:e,f=plIsset(b.scale)?b.scale:f,d+=sprintf('<div class="pl-input-group"  ><div class="pl-input-group-addon"><i class="pl-icon pl-icon-%s"></i></div><input id="%s" name="%s" type="text" class="pl-form-control dragger lstn" placeholder="" value="%s" data-max="%s" data-min="%s" data-default="%s" data-scale="%s"><span class="pl-input-group-addon">%s</span></div>',b.icon,b.inputID,b.inputID,b.value,g,h,i,f,e)}),this.optScripts.dragInput=function(){a(".dragger").not(".loaded").on("change blur",function(b){var c=a(this).val(),d=""!=c?parseFloat(c):"";max=a(this).data("max"),min=a(this).data("min"),d>max?d=max:d<min&&""!==d?d=min:_.isNaN(d)&&(d=""),c!=d&&a(this).val(d)}).addClass("loaded"),a(".dragger-reset").on("click",function(){a(this).parent().parent().find(".dragger").val("").trigger("keyup").trigger("blur")}).addClass("loaded"),a(".dragger-option .pl-input-group").not(".loaded").on("mousedown.dragdistance",function(b){var c=this,d=b.pageY,e=a(c).find(".dragger"),f=e.val(),g=2,h=e.data("scale"),i=h>=1?0:1;f=""===f?e.data("default"):f,a(document).on("mousemove.dragdistance",function(a){var b=Math.round((d-a.clientY)/g)*h,c=Number(1*f+b).toFixed(i);e.val(c).trigger("keyup")})}).addClass("loaded"),a(document).on("mouseup.dragdistance",function(){a(document).off("mousemove.dragdistance")}),a(".richtext-frame").on("load",function(){a(a("iframe.richtext-frame").contents()).on("mouseup.dragdistance",function(){a(document).off("mousemove.dragdistance")})}),$iDocument().on("mouseup.dragdistance",function(){a(document).off("mousemove.dragdistance")})},d+=sprintf("</div>")},coloroption:function(b){var c="",d=b.inputID;return c+=sprintf('<label for="%s">%s</label>',d,b.label),c+=sprintf('<div class="coloroption"><input id="%s" class="pl-colorpicker  lstn" type="text" name="%s" value="%s"/></div>',d,b.name,b.value),this.optScripts.coloroption=function(){a(".pl-colorpicker").not(".loaded").each(function(){a(this).wpColorPicker({change:function(b,c){var d=a(this);d.val(d.iris("color")).trigger("keyup");var e=_.debounce(function(){d.trigger("blur")},300,{leading:!1});e()}}).addClass("is-ready loaded")}),a(".wp-picker-clear").not(".loaded").on("click",function(){a(this).prev().trigger("keyup").trigger("blur")}).addClass("loaded")},c},checkoption:function(b){var c="",d="true"==b.value?1:b.value,d=parseInt(d),e=d&&0!==d&&""!==d?"checked":"",f="checked"===e?1:0,g=sprintf('<input class="checkbox-toggle lstn" id="%s"  name="%s" type="hidden" value="%s" />',b.inputID,b.name,f);return c+=sprintf('<div class="checkbox checkbox-group"><label><input id="%s" name="%s" class="checkbox-input" type="checkbox" %s> %s</label>%s</div>',b.inputID,b.name,e,b.label,g),this.optScripts.checkbox=function(){a(".checkbox-input:not(.loaded)").on("change",function(){var b=a(this).parent().next();a(this).is(":checked")?(a(this).val(1),b.val(1)):(a(this).val(0),b.val(0)),b.trigger("change")}).addClass("loaded")},c},_createAccordion:function(b){var c=this,d="",e=a.toolEngine.optGetValue(b.key),f="Item",g=0,h=(e.length||Object.keys(e).length,""),i=a.plEditing.reorderIcon();return a.each(e,function(e,j){b.itemNumber="item"+g,d+=sprintf("<div class='opt-group itemset item-closed' data-num='%s'><div class='opt-name item-toggle'>%s<span class='bar-title'>%s %s</span> <span class='pl-btn pl-btn-xs remove-item' style='%s'><i class='pl-icon pl-icon-remove'></i></span></div><div class='opt-accordion-opts item-contents'>",e,i,f,g+1,h),b.ind=e,b.vals=j,b.opts&&a.each(b.opts,function(c,e){d+=a.toolEngine.optEngine(e,b)}),d+=c.addHiddenInput(b.key,b.itemNumber),d+=sprintf("</div></div>"),g++}),d},_redoAccordion:function(b,c){var d=this;newAccordion=d._createAccordion(c),b.html(newAccordion),b.pagesort({handle:".opt-name",animation:150,draggable:".opt-group",onUpdate:function(e){d._resortAccordion(b,c),a.plEditing.setNeedsSave()}}),a.plEditing.itemToggles(),a.engineOpts.runScripts(),a.toolEngine.resetListenerBinding()},_resortAccordion:function(b,c){var d=this,e=[];b.find(".opt-group").each(function(){e.push(parseInt(a(this).attr("data-num")))}),$plModel().sortObservableArrayByArray(a.toolEngine.UID,c.key,e),d._redoAccordion(b,c)},accordion:function(b){var c=this,d="",e=sprintf('<script type="application/json" class="accordion-options">%s</script>',JSON.stringify(b));d+=sprintf('<div id="%s" name="%s" class="opt-accordion toolbox-sortable">',b.inputID,b.name),d+=c._createAccordion(b);var f=sprintf('<span class="pl-btn pl-btn-default pl-btn-xs add-accordion-item" >+ Add Item</span>');return d+=sprintf("</div><div class='accordion-tools'>%s%s</div>",e,f),c.optScripts.accordion=function(){a(".workarea-opts-form .opt-accordion").not(".loaded").each(function(){var b=a(this),d=a(this).closest(".pl-form-group"),e=JSON.parse(d.find(".accordion-options").html());b.pagesort({handle:".opt-name",animation:250,draggable:".opt-group",onUpdate:function(d){c._resortAccordion(b,e),a.plEditing.setNeedsSave()}})}).addClass("loaded"),a(".workarea-opts-form .opt-accordion").not(".del-loaded").delegate(".opt-name .remove-item","click",function(){var b=a(this).closest(".pl-form-group"),d=b.find(".opt-accordion"),e=a(this).closest(".opt-group"),f=JSON.parse(b.find(".accordion-options").html());d.find(".opt-group").length<=2&&d.find(".remove-item").hide();var g=e.data("num");$plModel().RemoveItemByIndex(a.toolEngine.UID,f.key,g),e.remove(),c._redoAccordion(d,f),a.plEditing.setNeedsSave("yes")}).addClass("del-loaded"),a(".add-accordion-item").not(".loaded").on("click",function(){var b=a(this).closest(".pl-form-group"),d=b.find(".opt-accordion"),e=JSON.parse(b.find(".accordion-options").html()),f={};a.each(e.opts,function(b,c){plIsset(c.key)&&(f[c.key]=""),"undefined"!=typeof c.opts&&a.each(c.opts,function(a,b){plIsset(b.key)&&(f[b.key]="")})}),$plModel().addItemToArray(a.toolEngine.UID,e.key,f),c._redoAccordion(d,e),a.plEditing.setNeedsSave("yes")}).addClass("loaded")},d},addHiddenInput:function(a,b){var c=this;return sprintf('<input type="hidden" class="lstn dont-change" id="%s_%s_showitem" name="%s[%s][%s][showitem]" value="1" />',a,b,c.uniqueID,a,b)},imagedropzone:function(b){var c=this,d=sprintf("pl-dropzone-%s",b.inputID),e=b.size||"",f="";f+=sprintf('<label for="%s">%s</label>',b.inputID,b.label),f+=sprintf('<div class="dropzone dropzone-option upload-box clearfix select-%s" data-select="%s" data-size="%s" >',b.name,b.name,e),f+=sprintf('<div class="pl-dropzone-actions ">'),f+=sprintf('<input type="text" id="%s" name="%s" class="%s lstn pl-form-control upload-input" placeholder="%s" value="%s" />',b.inputID,b.name,b.classes,b.place,b.value),f+=sprintf('<span class="pl-dropzone %s pl-btn pl-btn-primary pl-btn-xs">Upload</span>',d),f+=sprintf(' <span class="pl-load-media-lib pl-btn pl-btn-default pl-btn-xs">Media</span>',b.value),f+=sprintf(' <span class="pl-image-remove pl-btn pl-btn-default pl-btn-xs"><i class="pl-icon pl-icon-remove"></i></span>',b.value),f+=sprintf("</div>"),f+=sprintf('<div class="pl-dropzone-preview %s"></div>',b.inputID),f+=sprintf("</div>");var g='<div class="dz-preview dz-file-preview"><div class="dz-details"><div class="dz-meta"><div class="dz-filename"><span data-dz-name></span></div><div class="dz-size" data-dz-size></div></div><img data-dz-thumbnail /></div><div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div><div class="dz-success-mark"><i class="pl-icon pl-icon-ok"></i></div><div class="dz-error-mark"><i class="pl-icon pl-icon-remove"></i></div></div>';return c.optScripts.dropzoneUpload=function(){a(".dropzone-option").not(".loaded").each(function(){theDZ=a(this),theSelector="."+a(this).data("select"),theInput=theDZ.find(".upload-input"),thePreview=theDZ.find(".pl-dropzone-preview"),""!=theInput.val()&&thePreview.html(sprintf('<div class="dz-preview dz-file-preview"><img src="%s" /></div>',pl_do_shortcode(theInput.val()))),theDZ.find(".pl-dropzone").dropzone({url:PLWorkarea.ajaxURL,previewsContainer:thePreview[0],previewTemplate:g,sending:function(b,c,d){d.append("action","pl_server"),d.append("hook","pl_image_upload"),d.append("nonce",PLWorkarea.security);var e=a(a(this)[0].element);d.append("size",e.closest(".dropzone-option").data("size")),e.parent().next().find(".dz-preview:not(:last)").remove()},success:function(b,c){var d=c,e=a(a(this)[0].element);e.parent().find(".upload-input").val(d.url).trigger("blur")}})}).addClass("loaded"),a(".pl-image-remove").not(".loaded").on("click",function(){a(this).closest(".upload-box").find(".lstn").val("").trigger("blur").end().find(".dz-preview").fadeOut()}).addClass("loaded"),a(".pl-load-media-lib").not(".loaded").on("click",function(){var b;b="video"===a(this).data("mimetype")?PLWorkarea.mediaLibraryVideo:PLWorkarea.mediaLibrary;var c=a(this).closest(".upload-box").find(".upload-input"),d=c.attr("id");PLWorkarea.iframeSelector=d,bootbox.dialog({title:"Media Library",message:sprintf('<iframe class="modal-iframe" src="%s"></iframe>',b),animate:!1,className:"pl-modal modal-media",backdrop:!0,onEscape:!0}),a(".bootbox").on("hidden.mediaDialog",function(){c.trigger("blur").closest(".ui-accordion").accordion("refresh"),a(".bootbox").off("hidden.mediaDialog")})}).addClass("loaded")},f},radioOption:function(b){var c=this,d="";if(b.opts){var e="";a.each(b.opts,function(a,c){var d=c.val,f=("select_same"===b.type?c:c.name,b.value==d?"checked":""),g="undefined"!=typeof c.txt?" "+c.txt:"",h=b.inputID+a,i=c.hover||"",j=plIsset(c.icon)?sprintf('<i class="pl-icon pl-icon-%s"></i>',c.icon):"";e+=sprintf('<label for="%s" class="pl-btn pl-btn-default pl-btn-radio %s" title="%s">%s%s<input type="radio" class="input-radio lstn" name="%s" id="%s" value="%s" %s></label>',h,f,i,j,g,b.inputID,h,d,f)})}return d+=sprintf('<label for="%s">%s</label>',b.inputID,b.label),d+=sprintf('<div class="pl-btn-group pl-btn-radios">%s</div>',e),c.optScripts.radioSet=function(){a(".input-radio").not(".loaded").on("click",function(){var b=a(this),c=b.parent().parent();c.find(".pl-btn-radio").removeClass("checked"),c.find(".input-radio:checked").parent().addClass("checked")}).addClass("loaded"),a(".pl-btn-radios .input-radio:checked").parent().addClass("checked")},d},selectoption:function(b){var c="",d=b["default"]||"",e="select_multi"!==b.type?sprintf('<option value="%s" >Select</option>',d):"";if("count_select"===b.type||"count_select_same"===b.type||"select_pixels"===b.type||"select_vw"===b.type||"select_percent"===b.type||"select_proportion"===b.type){if("select_pixels"==b.type)var f=parseInt(b.count_start)||0,g=parseInt(b.count_number)||500,h=parseInt(b.count_mult)||25,j="px",k="px";else if("select_vw"==b.type)var f=parseInt(b.count_start)||10,g=parseInt(b.count_number)||100,h=parseInt(b.count_mult)||5,j="vw",k="vw";else if("select_proportion"==b.type||"select_percent"==b.type)var f=parseInt(b.count_start)||0,g=parseInt(b.count_number)||100,h=parseInt(b.count_mult)||10,j="%",k="select_proportion"==b.type?"":"%";else var f=parseInt(b.count_start)||0,g=parseInt(b.count_number)||10,h=parseInt(b.count_mult)||1,j=b.suffix||"",k="count_select_same"===b.type?b.suffix:"";for(b.opts={},i=f;i<=g;i+=h){var l="select_proportion"==b.type?i/100:i+k;b.opts[l]={name:i+j}}}if("select_wp_tax"===b.type){var m=PLWorkarea.taxes;b.opts={},a.each(m,function(a,c){b.opts[c]={name:c}})}else if("select_term"===b.type)a.engineOpts.optScripts.selectTerm=function(){a("#"+b.trigger).on("change load",function(c){var d=a(this);if(a(this).val()!=a(this).data("init")||"load"==c.type){var e={hook:"select_term",pt:a(this).val(),postSuccess:function(c){newopts=sprintf('<option value="">Select</option>'),a.each(c.opts,function(a,c){var d="";b.value===a&&(d="selected"),newopts+=sprintf('<option %s value="%s">%s</option>',d,a,c.name),newopts[a]={name:c.name}}),a("#"+b.key).html(newopts),d.data("init",d.val()).attr("data-init",d.val())}};$plServer().run(e)}}),a("#"+b.trigger).trigger("load")};else if("select_icon"===b.type)icons=PLWorkarea.icons,b.opts={},a.each(icons,function(a,c){b.opts[c]={name:c}});else if("select_animation"===b.type){var n=PLWorkarea.animations;b.opts={},a.each(n,function(a,c){b.opts[a]={name:c}})}else if("select_button"===b.type||"select_button_size"===b.type){if("select_button"===b.type)var o=PLWorkarea.btns;else var o=PLWorkarea.btnSizes;b.opts={},a.each(o,function(a,c){"0"===a&&(a=""),b.opts[a]={name:c}})}else if("select_sidebar"===b.type){var p=PLWorkarea.sidebars;b.opts={},a.each(p,function(a,c){b.opts[a]={name:c}})}else if("select_menu"===b.type){var q=PLWorkarea.menus;b.opts={},a.each(q,function(a,c){b.opts[a]={name:c}})}else if("select_imagesizes"===b.type){var r=PLWorkarea.imgSizes;b.opts={},a.each(r,function(a,c){b.opts[c]={name:c}})}b.opts&&a.each(b.opts,function(c,d){var f="select_same"===b.type?d:c,g="select_same"===b.type?d:d.name,h="";"object"==typeof b.value?a.each(b.value,function(a,b){f===b&&(h="selected")}):""!==b.value&&(h=b.value===f?"selected":""),e+=sprintf('<option value="%s" %s >%s</option>',f,h,g)});var s="select_multi"===b.type?"multiple":"";return c+=sprintf('<label for="%s">%s</label>',b.inputID,b.label),c+=sprintf('<select id="%s" name="%s" class="%s pl-form-control lstn" data-type="%s" data-init="%s" %s>%s</select>',b.inputID,b.name,b.classes,b.type,b.value,s,e),"select_taxonomy"===b.type&&b.post_type&&(c+=sprintf('<div style="margin-bottom: 10px;"><a href="%sedit.php?post_type=%s" target="_blank" class="pl-btn pl-btn-xs pl-btn-info"><i class="pl-icon pl-icon-edit"></i> %s</a></div>',PLWorkarea.adminURL,b.post_type,plTranslate("edit_sets"))),c}}}(window.jQuery),!function(a){window.$i=function(b){return"undefined"==typeof PLWorkarea.iframe||"undefined"==typeof PLWorkarea.iframe.contents()?a():PLWorkarea.iframe.contents().find(b)},window.$iDocument=function(){return a(PLWorkarea.iframe.contents())},window.$iWindow=function(){return a("iframe.site-frame")[0].contentWindow},window.$jq=function(){return $iWindow().jQuery},window.$pl=function(){return $iWindow().PLData},window.$plModel=function(){return $iWindow().jQuery.plModel},window.$plBinding=function(){return $iWindow().jQuery.plBinding},window.$plServer=function(){return $iWindow().jQuery.plServer},window.$iWindowEl=function(){return a(a("iframe.site-frame")[0].contentWindow)},a(document).ready(function(){a.plFrame.init()}),a.plFrame={init:function(){PLWorkarea.iframe=a("iframe.site-frame"),PLWorkarea.iframe.on("load",function(){a("title").html("Editing: "+pl_strip_html($pl().config.currentPageName)),a.plFrame.handleFrameLinks(),1==$pl().config.needsave?a.plEditing.setNeedsSave():a.plEditing.setNeedsSave("no"),""==$pl().urls.editPost?a(".editlink").addClass("disable-link").removeAttr("href").append('<span class="na"> (N/A)</span>'):a("#wp-admin-bar-edit > a").removeClass("disable-link").attr("href",$pl().urls.editPost).find(".na").remove()}),PLWorkarea.iframe.on("unload",function(){a(".iframe-loading-overlay").addClass("show-overlay")}),plAdjustAdminBar()},reloadFrame:function(b){var c=PLWorkarea.iframe.attr("src");b.needsave=1,a.each(b,function(a,b){c=updateQueryStringParameter(c,a,b)}),PLWorkarea.iframe.attr("src",c)},handleFrameLinks:function(){$i("body").delegate("a","click",function(b){var c=a(this),d=a(this).attr("href"),e=new RegExp(location.host),f=!1,g=a.plFrame.getProtocol(d),h=a.plFrame.getProtocol(PLWorkarea.iframe.attr("src")),i=!1;(c.data("rel")||c.hasClass("prettyPhoto")||c.hasClass("iframe-ignore-link")||c.hasClass("modal")||"_blank"==c.attr("target"))&&(f=!0),g!==h&&(console.log("Protocals are mismatched. Removing iFrame."),i=!0),"undefined"==typeof d||""===d||f||"#"!=d.slice(0,1)&&(b.preventDefault(),e.test(d)&&d.indexOf("wp-admin")<0&&!i?(d=d.split("#")[0],browserURL=updateQueryStringParameter(d,"pl_edit","on"),window.history.pushState("","",browserURL),d=updateQueryStringParameter(d,"iframe","true"),PLWorkarea.iframe.attr("src",d)):"_blank"==a(this).attr("target")?window.open(d):location.href=d)})},getProtocol:function(a){var b=document.createElement("a");return b.setAttribute("href",a),b.protocol},loadNew:function(a){if("undefined"==typeof a||!a)var a=PLWorkarea.homeURL;var b=PLWorkarea.iframe;b.trigger("unload"),b.fadeOut(300,function(){iframeURL=a,iframeURL=updateQueryStringParameter(iframeURL,"iframe","true"),iframeURL=updateQueryStringParameter(iframeURL,"rand",Math.floor(100000001*Math.random())),b.contents().find("*").unbind().remove(),b[0].src=iframeURL,PLWorkarea.iframe.fadeIn()})}}}(window.jQuery),function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){"use strict";a.fn.pagesort=function(b){var c;return this.each(function(){var d=a(this),e=d.data("sortable");if(e||!(b instanceof Object)&&b||(e=new Sortable(this,b),d.data("sortable",e)),e){if("widget"===b)return e;"destroy"===b?(e.destroy(),d.removeData("sortable")):b in e&&(c=e[e].apply(e,[].slice.call(arguments,1)))}}),void 0===c?this:c}}),function(a){"use strict";"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=a():"undefined"!=typeof Package?Sortable=a():window.Sortable=a()}(function(){"use strict";function a(a,b){this.el=a,this.options=b=b||{};var d={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1};for(var e in d)!(e in b)&&(b[e]=d[e]);var g=b.group;g&&"object"==typeof g||(g=b.group={name:g}),["pull","put"].forEach(function(a){a in g||(g[a]=!0)}),L.forEach(function(d){b[d]=c(this,b[d]||M),f(a,d.substr(2).toLowerCase(),b[d])},this),a[E]=g.name+" "+(g.put.join?g.put.join(" "):"");for(var h in this)"_"===h.charAt(0)&&(this[h]=c(this,this[h]));f(a,"mousedown",this._onTapStart),f(a,"touchstart",this._onTapStart),I&&f(a,"selectstart",this._onTapStart),f(a,"dragover",this._onDragOver),f(a,"dragenter",this._onDragOver),P.push(this._onDragOver),b.store&&this.sort(b.store.get(this))}function b(a){s&&s.state!==a&&(i(s,"display",a?"none":""),!a&&s.state&&t.insertBefore(s,q),s.state=a)}function c(a,b){var c=O.call(arguments,2);return b.bind?b.bind.apply(b,[a].concat(c)):function(){return b.apply(a,c.concat(O.call(arguments)))}}function d(a,b,c){if(a){c=c||G,b=b.split(".");var d=b.shift().toUpperCase(),e=new RegExp("\\s("+b.join("|")+")\\s","g");do if(">*"===d&&a.parentNode===c||(""===d||a.nodeName.toUpperCase()==d)&&(!b.length||((" "+a.className+" ").match(e)||[]).length==b.length))return a;while(a!==c&&(a=a.parentNode))}return null}function e(a){a.dataTransfer.dropEffect="move",a.preventDefault()}function f(a,b,c){a.addEventListener(b,c,!1)}function g(a,b,c){a.removeEventListener(b,c,!1)}function h(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(/\s+/g," ").replace(" "+b+" ","");a.className=d+(c?" "+b:"")}}function i(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return G.defaultView&&G.defaultView.getComputedStyle?c=G.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b),d[b]=c+("string"==typeof c?"":"px")}}function j(a,b,c){if(a){var d=a.getElementsByTagName(b),e=0,f=d.length;if(c)for(;f>e;e++)c(d[e],e);return d}return[]}function k(a){a.draggable=!1}function l(){J=!1}function m(a,b){var c=a.lastElementChild,d=c.getBoundingClientRect();return b.clientY-(d.top+d.height)>5&&c}function n(a){for(var b=a.tagName+a.className+a.src+a.href+a.textContent,c=b.length,d=0;c--;)d+=b.charCodeAt(c);return d.toString(36)}function o(a){for(var b=0;a&&(a=a.previousElementSibling)&&"TEMPLATE"!==a.nodeName.toUpperCase();)b++;return b}function p(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c),c=void 0},b))}}var q,r,s,t,u,v,w,x,y,z,A,B,C,D={},E="Sortable"+(new Date).getTime(),F=window,G=F.document,H=F.parseInt,I=!!G.createElement("div").dragDrop,J=!1,K=function(a,b,c,d,e,f){var g=G.createEvent("Event");g.initEvent(b,!0,!0),g.item=c||a,g.from=d||a,g.clone=s,g.oldIndex=e,g.newIndex=f,a.dispatchEvent(g)},L="onAdd onUpdate onRemove onStart onEnd onFilter onSort".split(" "),M=function(){},N=Math.abs,O=[].slice,P=[];return a.prototype={constructor:a,_dragStarted:function(){h(q,this.options.ghostClass,!0),a.active=this,K(t,"start",q,t,y)},_onTapStart:function(a){var b=a.type,c=a.touches&&a.touches[0],e=(c||a).target,g=e,h=this.options,i=this.el,l=h.filter;if(!("mousedown"===b&&0!==a.button||h.disabled)){if(h.handle&&(e=d(e,h.handle,i)),e=d(e,h.draggable,i),y=o(e),"function"==typeof l){if(l.call(this,a,e,this))return K(g,"filter",e,i,y),void a.preventDefault()}else if(l&&(l=l.split(",").some(function(a){return a=d(g,a.trim(),i),a?(K(a,"filter",e,i,y),!0):void 0})))return void a.preventDefault();if(e&&!q&&e.parentNode===i){"selectstart"===b&&e.dragDrop(),B=a,t=this.el,q=e,v=q.nextSibling,A=this.options.group,q.draggable=!0,h.ignore.split(",").forEach(function(a){j(e,a.trim(),k)}),c&&(B={target:e,clientX:c.clientX,clientY:c.clientY},this._onDragStart(B,!0),a.preventDefault()),f(G,"mouseup",this._onDrop),f(G,"touchend",this._onDrop),f(G,"touchcancel",this._onDrop),f(q,"dragend",this),f(t,"dragstart",this._onDragStart),f(G,"dragover",this);try{G.selection?G.selection.empty():window.getSelection().removeAllRanges()}catch(m){}}}},_emulateDragOver:function(){if(C){i(r,"display","none");var a=G.elementFromPoint(C.clientX,C.clientY),b=a,c=this.options.group.name,d=P.length;if(b)do{if((" "+b[E]+" ").indexOf(c)>-1){for(;d--;)P[d]({clientX:C.clientX,clientY:C.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode);i(r,"display","")}},_onTouchMove:function(a){if(B){var b=a.touches[0],c=b.clientX-B.clientX,d=b.clientY-B.clientY,e="translate3d("+c+"px,"+d+"px,0)";C=b,i(r,"webkitTransform",e),i(r,"mozTransform",e),i(r,"msTransform",e),i(r,"transform",e),this._onDrag(b),a.preventDefault()}},_onDragStart:function(a,b){var c=a.dataTransfer,d=this.options;if(this._offUpEvents(),"clone"==A.pull&&(s=q.cloneNode(!0),i(s,"display","none"),t.insertBefore(s,q)),b){var e,g=q.getBoundingClientRect(),h=i(q);r=q.cloneNode(!0),i(r,"top",g.top-H(h.marginTop,10)),i(r,"left",g.left-H(h.marginLeft,10)),i(r,"width",g.width),i(r,"height",g.height),i(r,"opacity","0.8"),i(r,"position","fixed"),i(r,"zIndex","100000"),t.appendChild(r),e=r.getBoundingClientRect(),i(r,"width",2*g.width-e.width),i(r,"height",2*g.height-e.height),f(G,"touchmove",this._onTouchMove),f(G,"touchend",this._onDrop),f(G,"touchcancel",this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else c&&(c.effectAllowed="move",d.setData&&d.setData.call(this,c,q)),f(G,"drop",this);if(u=d.scroll,u===!0){u=t;do if(u.offsetWidth<u.scrollWidth||u.offsetHeight<u.scrollHeight)break;while(u=u.parentNode)}setTimeout(this._dragStarted,0)},_onDrag:p(function(a){if(t&&this.options.scroll){var b,c,d=this.options,e=d.scrollSensitivity,f=d.scrollSpeed,g=a.clientX,h=a.clientY,i=window.innerWidth,j=window.innerHeight,k=(e>=i-g)-(e>=g),l=(e>=j-h)-(e>=h);k||l?b=F:u&&(b=u,c=u.getBoundingClientRect(),k=(N(c.right-g)<=e)-(N(c.left-g)<=e),l=(N(c.bottom-h)<=e)-(N(c.top-h)<=e)),D.vx===k&&D.vy===l&&D.el===b||(D.el=b,D.vx=k,D.vy=l,clearInterval(D.pid),b&&(D.pid=setInterval(function(){b===F?F.scrollTo(F.scrollX+k*f,F.scrollY+l*f):(l&&(b.scrollTop+=l*f),k&&(b.scrollLeft+=k*f))},24)))}},30),_onDragOver:function(a){var c,e,f,g=this.el,h=this.options,j=h.group,k=j.put,n=A===j,o=h.sort;if(void 0!==a.preventDefault&&(a.preventDefault(),!h.dragoverBubble&&a.stopPropagation()),!J&&A&&(n?o||(f=!t.contains(q)):A.pull&&k&&(A.name===j.name||k.indexOf&&~k.indexOf(A.name)))&&(void 0===a.rootEl||a.rootEl===this.el)){if(c=d(a.target,h.draggable,g),e=q.getBoundingClientRect(),f)return b(!0),void(s||v?t.insertBefore(q,s||v):o||t.appendChild(q));if(0===g.children.length||g.children[0]===r||g===a.target&&(c=m(g,a))){if(c){if(c.animated)return;y=c.getBoundingClientRect()}b(n);try{g.appendChild(q)}catch(p){}this._animate(e,q),c&&this._animate(y,c)}else if(c&&!c.animated&&c!==q&&void 0!==c.parentNode[E]){w!==c&&(w=c,x=i(c));var u,y=c.getBoundingClientRect(),z=y.right-y.left,B=y.bottom-y.top,C=/left|right|inline/.test(x.cssFloat+x.display),D=c.offsetWidth>q.offsetWidth,F=c.offsetHeight>q.offsetHeight,G=(C?(a.clientX-y.left)/z:(a.clientY-y.top)/B)>.5,H=c.nextElementSibling;if(J=!0,setTimeout(l,30),b(n),u=C?c.previousElementSibling===q&&!D||G&&D:H!==q&&!F||G&&F,u&&!H)try{g.appendChild(q)}catch(p){}else try{c.parentNode.insertBefore(q,u?H:c)}catch(p){}this._animate(e,q),this._animate(y,c)}}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();i(b,"transition","none"),i(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)"),b.offsetWidth,i(b,"transition","all "+c+"ms"),i(b,"transform","translate3d(0,0,0)"),clearTimeout(b.animated),b.animated=setTimeout(function(){i(b,"transition",""),b.animated=!1},c)}},_offUpEvents:function(){g(G,"mouseup",this._onDrop),g(G,"touchmove",this._onTouchMove),g(G,"touchend",this._onDrop),g(G,"touchcancel",this._onDrop)},_onDrop:function(b){var c=this.el,d=this.options;clearInterval(this._loopId),clearInterval(D.pid),g(G,"drop",this),g(G,"dragover",this),g(c,"dragstart",this._onDragStart),this._offUpEvents(),b&&(b.preventDefault(),!d.dropBubble&&b.stopPropagation(),r&&r.parentNode.removeChild(r),q&&(g(q,"dragend",this),k(q),h(q,this.options.ghostClass,!1),t!==q.parentNode?(z=o(q),K(q.parentNode,"sort",q,t,y,z),K(t,"sort",q,t,y,z),K(q,"add",q,t,y,z),K(t,"remove",q,t,y,z)):(s&&s.parentNode.removeChild(s),q.nextSibling!==v&&(z=o(q),K(t,"update",q,t,y,z),K(t,"sort",q,t,y,z))),a.active&&K(t,"end",q,t,y,z)),t=q=r=v=s=B=C=w=x=A=a.active=null,this.save())},handleEvent:function(a){var b=a.type;"dragover"===b?(this._onDrag(a),e(a)):"drop"!==b&&"dragend"!==b||this._onDrop(a)},toArray:function(){for(var a,b=[],c=this.el.children,e=0,f=c.length;f>e;e++)a=c[e],d(a,this.options.draggable,this.el)&&b.push(a.getAttribute("data-id")||n(a));return b},sort:function(a){var b={},c=this.el;this.toArray().forEach(function(a,e){var f=c.children[e];d(f,this.options.draggable,c)&&(b[a]=f)},this),a.forEach(function(a){b[a]&&(c.removeChild(b[a]),c.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return d(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;return void 0===b?c[a]:void(c[a]=b)},destroy:function(){var a=this.el,b=this.options;L.forEach(function(c){g(a,c.substr(2).toLowerCase(),b[c])}),g(a,"mousedown",this._onTapStart),g(a,"touchstart",this._onTapStart),g(a,"selectstart",this._onTapStart),g(a,"dragover",this._onDragOver),g(a,"dragenter",this._onDragOver),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),P.splice(P.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},a.utils={on:f,off:g,css:i,find:j,bind:c,is:function(a,b){return!!d(a,b,a)},throttle:p,closest:d,toggleClass:h,dispatchEvent:K,index:o},a.version="1.0.1",a.create=function(b,c){return new a(b,c)},a});