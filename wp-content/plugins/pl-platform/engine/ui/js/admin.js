/* PageLines Platform - 5.0.134
* Built: Wednesday, April 6th, 2016, 20:13
* http://www.pagelines.com
* Copyright (c) 2016 PageLines; Licensed GPL-3.0 */
!function(a){a(document).ready(function(){a.plAdmin.init(),a.plOptions.init(),a.plCustomizer.init(),a.plShortcodesEngine.init(),a.plAdminNotifications.init(),a.plCardsFav.init(),a.plCardsMulti.init()}),a.plAdminNotifications={init:function(){a(".pl-notice-dismiss").click(function(){var b=a(this).closest(".pl-notice"),c={id:b.data("id"),exp:b.data("exp"),action:"pl_admin_notice",nonce:PLAdmin.security};console.log(c),b.remove();var d={type:"POST",url:PLAdmin.ajaxurl,data:c,success:function(a){var b=a;console.log(b)}};a.ajax(d)})}},a.plCardsMulti={init:function(){var b=this;a(document).on("ready cards-loaded",function(){a(".extensions_multi_install").click(function(b){b.preventDefault();var c=JSON.parse(localStorage.getItem("multiCache")),d=[],e="",f=PLAdmin.extendURL+"&nonce="+PLAdmin.security;return a.each(c,function(a){d.push(a)}),e=d.join(),f=f+"&install_multi=true&slugs="+d,window.location.href=f,!1}),a(".card-multi").each(function(c){b.updateCheckbox(a(this)),a(this).change(function(){b.updateCheckboxState(a(this)),b.drawButton()})}),b.drawButton()})},updateCheckbox:function(b){var c=a(b).parent().parent().find(".actionlink").hasClass("button-disabled")||!1;if(c)return a(b).prop("disabled",!0),a(b).hide(),!1;var d=a(b).data("slug"),e=(a(b).is(":checked"),JSON.parse(localStorage.getItem("multiCache")));null===e&&(e={}),a.plAdmin.isset(e[d])&&a(b).prop("checked",!0)},updateCheckboxState:function(b){var c=a(b).data("slug"),d=a(b).is(":checked"),e=JSON.parse(localStorage.getItem("multiCache"));null===e&&(e={}),d?e[c]=c:null!==e[c]&&delete e[c],localStorage.setItem("multiCache",JSON.stringify(e))},drawButton:function(){var b=a(".extensions_multi_install"),c=(a(".extensions_multi_install .install-text"),JSON.parse(localStorage.getItem("multiCache"))||{}),d=Object.keys(c).length||0,e=sprintf("Install Selected Items (%s)",d);b.html(e),d>0?b.removeClass("disabled"):b.addClass("disabled")}},a.plCardsFav={init:function(){var b=window.location.href,c=a.plAdmin.getUrlVars(b);a(".pl-cards-nav li a").click(function(){a(".extensions_favs_install").fadeOut()}),a.plAdmin.isset(c.navitem)&&"extensions_favs"===c.navitem&&a(".extensions_favs_install").addClass("button").fadeIn(),a(".extensions_favs_install").click(function(a){a.preventDefault();var b=PLAdmin.extendURL+"&install_faves=true&nonce="+PLAdmin.security;return window.location.href=b,!1}),a(".extensions_favs").click(function(b){b.preventDefault();var c=a(this).attr("href"),d={action:"pl_card_fav_list",nonce:PLAdmin.security},e={type:"POST",url:PLAdmin.ajaxurl,data:d,success:function(b){var d=[];a.each(b.favs,function(a){d.push(a)}),c=c+"&special=favs&special_key="+d.join(),window.location.href=c}};return a.ajax(e),!1}),a(document).on("ready cards-loaded",function(){a(".card-fav").click(function(b){var c=a(this).data("slug"),d=sprintf('.card-fav[data-slug="%s"]',c);a(d).html('<i class="fa fa-refresh fa-spin"></i>');var e={action:"pl_card_fav",slug:c,nonce:PLAdmin.security},f={type:"POST",url:PLAdmin.ajaxurl,data:e,success:function(b){var d=b["class"]||"pl-icon pl-icon-star-o",e=sprintf('.card-fav[data-slug="%s"]',c),f=sprintf('<i class="%s"></i>',d);a(e).html(f),localStorage.clear()}};return a.ajax(f),!1})})}},a.plAdmin={init:function(){var b=this,c=window.location.pathname.match(/.*\/([^/]+)\.([^?]+)/i);queryString=window.location.href,urlVars=b.getUrlVars(queryString),refresh=!1,refresh_array=["plugins","themes","update","update-core"],doc=null!==c?c[1]:"unknown",1==urlVars.refresh&&(refresh=!0,delete urlVars.refresh),-1!==a.inArray(doc,refresh_array)&&(refresh=!0),!0===refresh&&localStorage.clear(),a(".pl-cards").length>0&&b.doCardSetup(a(".pl-cards"))},doCardSetup:function(b){var c=this;c.doCardFilterLink(window.location.href),a("body").delegate(".pl-filter-links a","click",function(b){b.preventDefault();var d=a(this).attr("href");window.history.pushState("","",d),c.doCardFilterLink(d)})},doCardFilterLink:function(b){var c=this,d=a(".pl-cards").data("hook")||"extend";c.getUrlVars(b);c.cardRequest({hook:d,query:b})},cardRequest:function(b){var c=this,d=b.query||window.location.href,e=c.getUrlVars(d);delete e.page,delete e.tab,1==e.refresh&&(c.cardCacheReset(),delete e.refresh),a.isEmptyObject(e)&&a(".pl-filter-links a").first().length>0&&(d=a(".pl-filter-links li a").first().attr("href"),e=c.getUrlVars(d)),c.doCardTitle(e);var f={queryVars:e,key:d,beforeSend:function(){a(".pl-cards").html('<div class="pl-loading-banner"><div class="ic"><i class="pl-icon pl-icon-cog pl-icon-spin"></i></div><div>Loading</div></div>')},postSuccess:function(a){c.doProductCards(a.cards,b.key),c.cardCache(b.key,a.cards)}};b=a.extend(f,b);var g=c.cardCache(b.key);g?c.doProductCards(g,b.key):c.request(b)},request:function(b){var c=a.extend({action:"pl_platform"},b);c.nonce=PLAdmin.security,delete c.beforeSend,delete c.postSuccess;var d={type:"POST",url:PLAdmin.ajaxurl,data:c,beforeSend:function(){a.isFunction(b.beforeSend)&&b.beforeSend.call(this)},success:function(c){var d=c;return a.isFunction(b.postSuccess)?void b.postSuccess.call(this,d):d}};a.ajax(d)},cardCacheReset:function(){localStorage.setItem(PLAdmin.cachekey,JSON.stringify({}))},cardCache:function(a,b){var b=b||!1;if(b!==!1)return cardCache=JSON.parse(localStorage.getItem(PLAdmin.cachekey)),cardCache="undefined"!=typeof cardCache&&null!==cardCache?cardCache:{},cardCache[a]=b,cardCache.timestamp=(new Date).getTime().toString(),localStorage.setItem(PLAdmin.cachekey,JSON.stringify(cardCache)),!0;cardCache=JSON.parse(localStorage.getItem(PLAdmin.cachekey))||{};var c=cardCache.timestamp,d=(new Date).getTime().toString(),e=(d-c)/36e5;return e>=8||null==cardCache[a]?!1:cardCache[a]},doCardTitle:function(b){var c="PageLines Store";"undefined"!=typeof b.s?c="Search: "+b.s:a("."+b.navitem).length>0&&(c=a("."+b.navitem).attr("title")),a(".pl-filter-links a").removeClass("current"),a("."+b.navitem).addClass("current"),a(".pl-store-title").html(c)},doProductCards:function(b,c){var d=this,e="",f="",g=!0;if(a.isEmptyObject(b))e+=d.banner({img:"",header:"Nothing Found",subhead:"Nothing was found for the selected query.",content:""});else if("undefined"!=typeof b.html)g=!1,e+=b.html;else if("undefined"!=typeof b.error)e+=d.banner({img:"",header:"Error Loading Data",subhead:"If the problem persists please contact PageLines support.",content:sprintf('<a class="button button-refresh" href="%s"><i class="pl-icon pl-icon-refresh"></i> Refresh User Data</a>',PLAdmin.refreshURL)}),console.log("Error: "+b.error),console.log("Description: "+b.error_description);else{var h=b[0].total_pages||1,f=d.pagination(h,c);a.each(b,function(a,b){var c=sprintf('<a target="_blank" href="%s" class="pl-product-thumb"><img src="%s"></a>',b.product_link,b.thumb),f=sprintf('<div class="desc column-description"><p>%s</p></div>',b.post_excerpt),g=sprintf('<div class="name column-name"><h4><a href="%s">%s</a></h4>%s</div>',b.product_link,b.post_title,d.getCardMetahead(b));action=sprintf('<div class="action-links">%s</div>',b.actionlink),tags=sprintf('<div class="card-tags pl-filter-links"><i class="pl-icon pl-icon-tags"></i> %s</div>',d.getCardTags(b)),meta=sprintf('<div class="product-meta">%s %s</div>',d.getCardMeta(b),tags),content=sprintf('<div class="card-content">%s %s %s</div>%s',g,f,action,meta),e+=sprintf('<div class="pl-product-card pl-col-sm-4 pl-col-lg-3"><div class="pl-product-card-pad">%s %s</div></div>',c,content)})}var i=g?sprintf('<div class="pl-row">%s</div>%s',e,f):sprintf("%s",e);a(".pl-cards").html(i),a(".pl-product-card").each(function(b){var c=a(this);setTimeout(function(){c.addClass("animation-loaded hovered"),setTimeout(function(){c.removeClass("hovered")},700)},100*b)}),a(".pl-cards-nav, .pl-cards-sidebar").addClass("loaded"),a("body").trigger("cards-loaded")},pagination:function(a,b){for(var c=this,d="",e=c.getQueryVar("getpaged")||1,f=1;a>=f;f++){var g=e==f?"current":"";d+=sprintf('<a class="%s" href="%s&getpaged=%s">%s</a>',g,b,f,f)}return sprintf('<div class="pl-store-pagination">%s</div>',d)},getCardMetahead:function(a){return meta=[],a.slug.indexOf("pl-framework")>-1?a.slug.indexOf("pl-framework-")>-1?meta.push("Framework Child Theme"):meta.push("Framework Theme"):a.slug.indexOf("pl-plugin")>-1?meta.push("PageLines Plugin"):a.slug.indexOf("pl-section")>-1?meta.push("Drag &amp; Drop Section"):meta.push("WordPress Plugin"),sprintf('<div class="metabar">%s%s</div>',meta.join(", "),a.version_html)},getCardTags:function(b){var c=a(".pl-cards-ui").data("baseurl"),d=[];return a.each(b.tags,function(a,b){d.push(sprintf('<a href="%s&product_tag=%s">%s</a>',c,b.slug,b.name))}),d.join('<span class="comma">, </span>')},getCardMeta:function(a){var b=this,c=[],d=a.fav||"pl-icon pl-icon-star-o";a.notes&&c.push(sprintf('<a target="_blank" href="%s" class="demo-btn">Notes</a>',a.notes)),a.reviews>0&&c.push(sprintf('<span class="star-rating">%s <span class="num-ratings">(%s)</span></span>',b.getStarRating(a.rating),a.reviews)),a.demo&&c.push(sprintf('<a target="_blank" href="%s" class="demo-btn">Demo</a>',a.demo)),a.docs&&c.push(sprintf('<a target="_blank" href="%s" class="demo-btn">Docs</a>',a.docs));a.download_count;return c.push(sprintf('<span class="num-downloads"><i class="pl-icon pl-icon-download"></i> <span>%s</span></span>',a.download_count)),c.push(sprintf('<span title="%s" class="card-fav" data-slug="%s"> <i class="%s"></i></span>',"Add/Remove favorite",a.slug,d)),"plugin"===a.install_type&&c.push(sprintf('<input title="%s" type="checkbox" class="card-multi" data-slug="%s" />',"Select Multi Install",a.slug,d)),c.join('<span class="divider">|</span>')},getStarRating:function(a){var b="",c=Math.round(2*a)/2,d="star";for(i=1;i<=5;i++)0>=c?d="star-o":1>c&&(d="star-half-full"),b+=sprintf('<i class="pl-icon pl-icon-%s"></i>',d),c--;return b},getActionLink:function(a){return'<a href="#" class="button button-primary">Link</a>'},banner:function(a){return banner=sprintf('<div class="pl-col-sm-12"><div class="pl-platform-banner"><div class="pl-platform-banner-inner">%s<div class="banner-body"><div class="banner-body-pad"><h2 class="banner-header" >%s</h2><div class="banner-subheader">%s</div><div class="pl-platform-banner-content">%s</div></div></div></div></div></div>',a.img,a.header,a.subhead,a.content),banner},getQueryVar:function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}},getUrlVars:function(a){for(var b,c={},d=a.slice(a.indexOf("?")+1).split("&"),e=0;e<d.length;e++)b=d[e].split("="),c[b[0]]=b[1];return c},isset:function(a){return"undefined"!=typeof a&&null!==a}},a.plCustomizer={init:function(){var b=this;a("body").hasClass("wp-customizer")&&(b.scriptOptions(),b.editUI())},editUI:function(){var b=wp.customize;a(b).on("ready",function(){a(".customize-control-description").addClass("pl-hide").parent().find(".customize-control-title").append('<span class="pl-more-info">About <i class="pl-icon pl-icon-caret-down"></i><i class="pl-icon pl-icon-caret-up"></i></span>'),a(".pl-more-info").on("click",function(b){b.stopPropagation(),b.preventDefault(),a(this).hasClass("show-info")?a(this).removeClass("show-info").closest("label").find(".customize-control-description").addClass("pl-hide"):a(this).addClass("show-info").closest("label").find(".customize-control-description").removeClass("pl-hide")})})},scriptOptions:function(){var b={},c=wp.customize;a(c).on("ready",function(){a(".pl-code-editor").each(function(c){var d=a(this).data("mode"),e=a.extend({},cm_base_config,{mode:d});b["item"+c]=CodeMirror.fromTextArea(a(this).get(0),e),b["item"+c].el=a(this),a(this).parent().addClass("is-ready")}),a(c).on("expanded",function(){a.each(b,function(a,b){b.refresh()})}),a.each(b,function(a,b){b.on("change",function(){var a=b.getValue();b.el.parent().find(".the-value").val(a).trigger("change")})})})}},a.plOptions={init:function(){that=this,a(".pl-admin-settings").length>0&&that.specialOptions()},specialOptions:function(){var b=this,c={};if(b.imageUploaders(),a(".pl-colorpicker").wpColorPicker().addClass("is-ready"),a(".checkbox-input").on("change",function(){var b=a(this).prev();a(this).is(":checked")?b.val(1):b.val(0)}),a(".pl-settings-tabs").length>0){var d=localStorage.getItem("pl_admin_settings_tab");if(""==d||!d)var d=a(".pl-settings-tabs").data("selected");if(""!=d&&"default"!=d&&a("#"+d).length>0)var e=a("#"+d);else var e=a(".pl-tab-panel").first();e.addClass("selected"),a(sprintf('[href="#%s"]',e.attr("id"))).addClass("selected"),a(".pl-settings-tabs").find(".pl-settings-nav a").on("click",function(b){b.preventDefault(),a(".pl-tab-panel").removeClass("selected"),a(".pl-settings-nav a").removeClass("selected");var d=a(this).attr("href");a(d).addClass("selected"),a(this).addClass("selected"),a(d).hasClass("tab-disabled")&&a(d).find(".pl-opt").attr("disabled",!0),a.each(c,function(a,b){b.refresh()}),a(".selected_tab_input").val(a(d).attr("id")),localStorage.setItem("pl_admin_settings_tab",a(d).attr("id"))}),a(".pl-settings-tabs").addClass("loaded"),a(".pl-code-editor").each(function(b){var d=a(this).data("mode"),e=a.extend({},cm_base_config,{mode:d});c["item"+b]=CodeMirror.fromTextArea(a(this).get(0),e),a(this).parent().addClass("is-ready")})}},imageUploaders:function(){var b;a(".image_upload_button").on("click",function(c){c.preventDefault();var d=a(this),e=d.closest(".image_uploader");mode=d.data("mode"),handling=d.data("handling");var f={multiple:!1,library:{type:mode}};b=wp.media.frames.file_frame=wp.media(f),b.on("select",function(){if(attachment=b.state().get("selection").first().toJSON(),"id"==handling)var a=attachment.id;else var a=attachment.url;e.find(".upload_image_option").val(a),e.find(".the_preview_image").attr("src",attachment.url)}),b.open()})}}}(window.jQuery),!function(a){a.plShortcodesEngine={init:function(){var a=this;a.bindUIActions()},bindUIActions:function(){var b=this;a("body").delegate(".pl-shortcode-tb","click",function(){setTimeout(function(){a("#TB_ajaxContent").css("height","auto")},30)}),a("body").delegate(".plsc-show-list","click",function(){b.showList()}),a("body").delegate(".btn-add-shortcode","click",function(){var c=(a(this).closest("#TB_window"),a(this).data("key")),d="";b.showEngine(),a("#TB_ajaxContent").css("height","auto");var e=PLAdmin.shortcodes[c],f="";a.isEmptyObject(e.settings)?f+='<div class="plsc-option">No settings for this shortcode.</div>':a.each(e.settings,function(a,c){c.key=a,f+=b.engine(c)});var g='<a href="#" class="button plsc-show-list"><i class="pl-icon pl-icon-chevron-left"></i> Back to list</a>';d+=sprintf('<div class="plsc-iframe-label" ><span><i class="pl-icon pl-icon-%s"></i> %s Shortcode Setup</span>%s</div>',e.icon,e.title,g),d+=sprintf('<div class="plsc-settings" data-key="%s">%s</div>',c,f),a(".plsc-options-container").html(d)}),a(".plsc").on("click",".plsc-insert",function(a){a.preventDefault();var c=b.parseShortcode();window.wp.media.editor.insert(c)})},showEngine:function(){a(".plsc").addClass("show-engine")},showList:function(){a(".plsc").removeClass("show-engine")},parseShortcode:function(){var b=a(".plsc-settings").data("key"),c="",d="";a(".plsc-settings").find(".plsc-input").each(function(){var b=a(this).val(),e=a(this).data("key");""!=b&&"content"!=e&&(c+=sprintf(' %s="%s"',e,b)),"content"==e&&(d+=b)});var e=sprintf("[%s%s]",b,c);return""!=d&&(e+=sprintf("%s[/%s]",d,b)),e},engine:function(b){var c=sprintf('<label class="plsc-option-label">%s</label>',b.label),d=b["default"]||"";if("text"==b.type)c+=sprintf('<input type="text" class="plsc-input" data-key="%s" value="%s" placeholder="%s" />',b.key,d,b.place);else if("textarea"==b.type)c+=sprintf('<textarea rows="4" cols="50" class="plsc-input" data-key="%s" placeholder="%s">%s</textarea>',b.key,b.place,d);else if("select"==b.type||"select_same"==b.type||"count_select"==b.type||"select_section"==b.type){var e="";if("count_select"==b.type)for(b.opts={},i=b.count_start;i<=b.count_end;i++)b.opts[i]=i;"select_section"==b.type&&(b.opts={},a.each(PLAdmin.sections,function(a,c){b.opts[a]=a})),a.each(b.opts,function(a,c){var d;d="select_same"==b.type?c:a,e+=sprintf('<option value="%s">%s</option>',d,c)}),c+=sprintf('<select class="plsc-input" data-key="%s">%s</select>',b.key,e)}else c+=sprintf('"%s" shortcode option type is missing.',b.type);return b.desc&&(c+=sprintf('<span class="plsc-option-description">%s</span>',b.desc)),sprintf('<div class="plsc-option">%s</div>',c)}}}(window.jQuery),function(a){function b(){var a=arguments[0],c=b.cache;return c[a]&&c.hasOwnProperty(a)||(c[a]=b.parse(a)),b.format.call(null,c[a],arguments)}function c(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function d(a,b){return new Array(b+1).join(a)}var e={not_string:/[^s]/,number:/[dief]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fiosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};b.format=function(a,f){var g,h,i,j,k,l,m,n=1,o=a.length,p="",q=[],r=!0,s="";for(h=0;o>h;h++)if(p=c(a[h]),"string"===p)q[q.length]=a[h];else if("array"===p){if(j=a[h],j[2])for(g=f[n],i=0;i<j[2].length;i++){if(!g.hasOwnProperty(j[2][i]))throw new Error(b("[sprintf] property '%s' does not exist",j[2][i]));g=g[j[2][i]]}else g=j[1]?f[j[1]]:f[n++];if("function"===c(g)&&(g=g()),e.not_string.test(j[8])&&"number"!==c(g)&&isNaN(g))throw new TypeError(b("[sprintf] expecting number but found %s",c(g)));switch(e.number.test(j[8])&&(r=g>=0),j[8]){case"b":g=g.toString(2);break;case"c":g=String.fromCharCode(g);break;case"d":case"i":g=parseInt(g,10);break;case"e":g=j[7]?g.toExponential(j[7]):g.toExponential();break;case"f":g=j[7]?parseFloat(g).toFixed(j[7]):parseFloat(g);break;case"o":g=g.toString(8);break;case"s":g=(g=String(g))&&j[7]?g.substring(0,j[7]):g;break;case"u":g>>>=0;break;case"x":g=g.toString(16);break;case"X":g=g.toString(16).toUpperCase()}!e.number.test(j[8])||r&&!j[3]?s="":(s=r?"+":"-",g=g.toString().replace(e.sign,"")),l=j[4]?"0"===j[4]?"0":j[4].charAt(1):" ",m=j[6]-(s+g).length,k=j[6]&&m>0?d(l,m):"",q[q.length]=j[5]?s+g+k:"0"===l?s+k+g:k+s+g}return q.join("")},b.cache={},b.parse=function(a){for(var b=a,c=[],d=[],f=0;b;){if(null!==(c=e.text.exec(b)))d[d.length]=c[0];else if(null!==(c=e.modulo.exec(b)))d[d.length]="%";else{if(null===(c=e.placeholder.exec(b)))throw new SyntaxError("[sprintf] unexpected placeholder");if(c[2]){f|=1;var g=[],h=c[2],i=[];if(null===(i=e.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(g[g.length]=i[1];""!==(h=h.substring(i[0].length));)if(null!==(i=e.key_access.exec(h)))g[g.length]=i[1];else{if(null===(i=e.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");g[g.length]=i[1]}c[2]=g}else f|=2;if(3===f)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");d[d.length]=c}b=b.substring(c[0].length)}return d};var f=function(a,c,d){return d=(c||[]).slice(0),d.splice(0,0,a),b.apply(null,d)};"undefined"!=typeof exports?(exports.sprintf=b,exports.vsprintf=f):(a.sprintf=b,a.vsprintf=f,"function"==typeof define&&define.amd&&define(function(){return{sprintf:b,vsprintf:f}}))}("undefined"==typeof window?this:window);